<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Fundamental Analysis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-graph-up"></i> Stock Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="analysis.html">
                            <i class="bi bi-bar-chart-line"></i> Fundamental Analysis
                        </a>
                    </li>
                    <li class="nav-item d-flex align-items-center ms-2">
                        <button class="btn btn-sm btn-outline-light" id="themeToggle" title="Toggle theme">
                            <i class="bi bi-moon-fill" id="themeIcon"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container-fluid py-4">
        <div class="header-section">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-2"><i class="bi bi-graph-up-arrow"></i> Stock Fundamental Analysis</h1>
                    <p class="mb-0">Add stocks and enter data manually for analysis</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <span class="stock-count-badge">
                        <i class="bi bi-collection"></i> <span id="stockCount">0</span> Stocks
                    </span>
                </div>
            </div>
        </div>

        <!-- Add Stock Form -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="bi bi-plus-circle"></i> Add New Stock</h5>
            </div>
            <div class="card-body">
                <form id="addStockForm" class="add-stock-form">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="stockSymbol" class="form-label">Stock Symbol *</label>
                            <input type="text" class="form-control" id="stockSymbol" 
                                   placeholder="e.g., TCS, RELIANCE, HDFC" 
                                   required autocomplete="off">
                        </div>
                        <div class="col-md-4">
                            <label for="stockName" class="form-label">Company Name *</label>
                            <input type="text" class="form-control" id="stockName" 
                                   placeholder="e.g., Tata Consultancy Services" 
                                   required>
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-primary w-100" type="submit" id="addBtn">
                                <span class="loading-spinner spinner-border spinner-border-sm me-1"></span>
                                <i class="bi bi-plus"></i> Add Stock
                            </button>
                        </div>
                    </div>
                    <small class="text-muted mt-2 d-block">
                        <i class="bi bi-info-circle"></i> After adding, click "Edit" to enter stock details and prices manually.
                    </small>
                </form>
            </div>
        </div>

        <!-- Alert Container -->
        <div id="alertContainer"></div>

        <!-- Stocks Analysis Table -->
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-table"></i> Stock Fundamental Analysis</h5>
                <button class="btn btn-sm btn-outline-danger" id="clearAllBtn" style="display: none;">
                    <i class="bi bi-trash"></i> Clear All
                </button>
            </div>
            <div class="card-body p-0">
                <div class="table-container">
                    <table class="table table-hover table-bordered analysis-table mb-0" id="stocksTable">
                        <thead class="table-dark">
                            <tr>
                                <th style="width: 60px;">S.No</th>
                                <th style="min-width: 150px;">Stock Name</th>
                                <th>Liquidity</th>
                                <th>Quick Ratio</th>
                                <th>Debt/Equity</th>
                                <th>ROE (%)</th>
                                <th>Investor Growth</th>
                                <th>ROA (%)</th>
                                <th>EBITDA Latest</th>
                                <th>EBITDA Previous</th>
                                <th>Div Yield (%)</th>
                                <th>Stock PE</th>
                                <th>Industry PE</th>
                                <th>P/B</th>
                                <th>P/S YoY</th>
                                <th>BETA</th>
                                <th>Promoter %</th>
                                <th style="width: 150px;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="metricsBody">
                            <!-- Stock rows will be added dynamically -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Empty State -->
                <div class="empty-state" id="emptyState">
                    <i class="bi bi-bar-chart-line"></i>
                    <h4>No Stocks Added Yet</h4>
                    <p>Add stocks using the form above to start your fundamental analysis</p>
                </div>
            </div>
        </div>

        <!-- Metrics Legend -->
        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-info-circle"></i> Metrics Guide</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <h6 class="text-primary">Liquidity & Leverage</h6>
                        <ul class="small">
                            <li><strong>Liquidity:</strong> Cash > Debt indicates financial health</li>
                            <li><strong>Quick Ratio:</strong> > 1 is good (immediate bill paying ability)</li>
                            <li><strong>Debt/Equity:</strong> < 1 is generally preferred</li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h6 class="text-primary">Profitability</h6>
                        <ul class="small">
                            <li><strong>ROE:</strong> > 15% is excellent</li>
                            <li><strong>ROA:</strong> > 5% indicates efficient asset use</li>
                            <li><strong>EBITDA:</strong> Operating profitability measure</li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h6 class="text-primary">Valuation</h6>
                        <ul class="small">
                            <li><strong>P/E:</strong> Compare with industry PE</li>
                            <li><strong>P/B:</strong> < 1 may indicate undervaluation</li>
                            <li><strong>P/S:</strong> Lower is generally better</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Manual Data Entry Modal -->
    <div class="modal fade" id="manualDataModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="bi bi-pencil-square"></i> Manual Data Entry</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="manualDataForm">
                        <input type="hidden" id="modalStockSymbol">
                        
                        <h6 class="border-bottom pb-2 mb-3">Stock Information</h6>
                        <div class="row g-3">
                            <div class="col-md-12">
                                <label for="modalName" class="form-label">Company Name</label>
                                <input type="text" class="form-control" id="modalName">
                            </div>
                        </div>
                        
                        <h6 class="border-bottom pb-2 mb-3 mt-4">Fundamental Metrics (13 Metrics)</h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="modalLiquidity" class="form-label">1. Liquidity (Cash More than Debt)</label>
                                <input type="text" class="form-control" id="modalLiquidity" placeholder="e.g., Good (1.5x), Poor (0.8x)">
                            </div>
                            <div class="col-md-6">
                                <label for="modalQuickRatio" class="form-label">2. Quick Ratio</label>
                                <input type="number" step="0.01" class="form-control" id="modalQuickRatio" placeholder="e.g., 1.2">
                            </div>
                            <div class="col-md-6">
                                <label for="modalDebtEquity" class="form-label">3. Leverage (Debt Equity Ratio)</label>
                                <input type="number" step="0.01" class="form-control" id="modalDebtEquity" placeholder="e.g., 0.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalROE" class="form-label">4. ROE (%)</label>
                                <input type="number" step="0.01" class="form-control" id="modalROE" placeholder="e.g., 15.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalInvestorGrowth" class="form-label">5. Investor's Money Growth Ratio (%)</label>
                                <input type="number" step="0.01" class="form-control" id="modalInvestorGrowth" placeholder="e.g., 12.0">
                            </div>
                            <div class="col-md-6">
                                <label for="modalROA" class="form-label">6. Return on Asset (%)</label>
                                <input type="number" step="0.01" class="form-control" id="modalROA" placeholder="e.g., 8.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalEBITDACurrent" class="form-label">7a. EBITDA Latest FY</label>
                                <input type="text" class="form-control" id="modalEBITDACurrent" placeholder="e.g., ₹5000Cr">
                            </div>
                            <div class="col-md-6">
                                <label for="modalEBITDAPrevious" class="form-label">7b. EBITDA Previous FY</label>
                                <input type="text" class="form-control" id="modalEBITDAPrevious" placeholder="e.g., ₹4500Cr">
                            </div>
                            <div class="col-md-6">
                                <label for="modalDividendYield" class="form-label">8. Dividend Yield (%)</label>
                                <input type="number" step="0.01" class="form-control" id="modalDividendYield" placeholder="e.g., 2.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalPE" class="form-label">9a. Stock PE</label>
                                <input type="number" step="0.01" class="form-control" id="modalPE" placeholder="e.g., 25.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalIndustryPE" class="form-label">9b. Industry PE</label>
                                <input type="number" step="0.01" class="form-control" id="modalIndustryPE" placeholder="e.g., 28.0">
                            </div>
                            <div class="col-md-6">
                                <label for="modalPriceToBook" class="form-label">10. Price to Book (P/B)</label>
                                <input type="number" step="0.01" class="form-control" id="modalPriceToBook" placeholder="e.g., 3.5">
                            </div>
                            <div class="col-md-6">
                                <label for="modalPriceToSales" class="form-label">11. Price to Sales (P/S) YoY</label>
                                <input type="text" class="form-control" id="modalPriceToSales" placeholder="e.g., 2.5 (Increasing)">
                            </div>
                            <div class="col-md-6">
                                <label for="modalBeta" class="form-label">12. BETA</label>
                                <input type="number" step="0.01" class="form-control" id="modalBeta" placeholder="e.g., 1.2">
                            </div>
                            <div class="col-md-6">
                                <label for="modalPromoterHoldings" class="form-label">13. Promoter Holdings (%)</label>
                                <input type="number" step="0.01" class="form-control" id="modalPromoterHoldings" placeholder="e.g., 65.5">
                            </div>
                        </div>
                        
                        <h6 class="border-bottom pb-2 mb-3 mt-4">Price Data (Optional)</h6>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="modalDate" class="form-label">Date</label>
                                <input type="date" class="form-control" id="modalDate">
                            </div>
                            <div class="col-md-4">
                                <label for="modalOpen" class="form-label">Open Price</label>
                                <input type="number" step="0.01" class="form-control" id="modalOpen">
                            </div>
                            <div class="col-md-4">
                                <label for="modalHigh" class="form-label">High Price</label>
                                <input type="number" step="0.01" class="form-control" id="modalHigh">
                            </div>
                            <div class="col-md-4">
                                <label for="modalLow" class="form-label">Low Price</label>
                                <input type="number" step="0.01" class="form-control" id="modalLow">
                            </div>
                            <div class="col-md-4">
                                <label for="modalClose" class="form-label">Close Price</label>
                                <input type="number" step="0.01" class="form-control" id="modalClose">
                            </div>
                            <div class="col-md-4">
                                <label for="modalVolume" class="form-label">Volume</label>
                                <input type="number" class="form-control" id="modalVolume">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveDataBtn">
                        <i class="bi bi-save"></i> Save Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        <p>&copy; 2025 Stock Analysis Dashboard.</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/analysis.js"></script>
</body>
</html>
